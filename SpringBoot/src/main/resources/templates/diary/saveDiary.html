<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
  <title>Instagram</title>
  <link href="/css/common.css" rel="stylesheet" type="text/css" />
  <link href="/css/main.css" rel="stylesheet" type="text/css" />
  <!-- favicon -->
  <link rel="icon" href="/img/favicon.png">
  <link rel="instagram-icon" href="/img/favicon.png">
</head>
<!-- ì‚¬ìš©ì ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€ -->
<th:block layout:fragment="script">

  <script th:inline="javascript">
    $(document).ready(function(){
      let errorMessage = [[${errorMessage}]]; <!-- th:inline="javascript"ì´ ìˆì–´ì•¼ë§Œ ì—ëŸ¬ë©”ì‹œì§€ ì¸ì‹ë¨ -->
      if(errorMessage != null){
        alert(errorMessage);
      }

      bindDomEvent();

    });

    function bindDomEvent(){
      $("#photo").on("change", function() {
        let fileName = $(this).val().split("\\").pop();  //ì´ë¯¸ì§€ íŒŒì¼ëª…
        let fileExt = fileName.substring(fileName.lastIndexOf(".")+1); // í™•ì¥ì ì¶”ì¶œ
        fileExt = fileExt.toLowerCase(); //ì†Œë¬¸ì ë³€í™˜
        //íŒŒì¼ ì²¨ë¶€ ì‹œ ì´ë¯¸ì§€ íŒŒì¼ì¸ì§€ ê²€ì‚¬í•œë‹¤.
        if(fileExt != "jpg" && fileExt != "jpeg" && fileExt != "gif" && fileExt != "png" && fileExt != "bmp"){
          alert("ì´ë¯¸ì§€ íŒŒì¼ë§Œ ë“±ë¡ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.");
          return;
        }
        //í™”ë©´ì— íŒŒì¼ëª…ì„ ë‚˜íƒ€ë‚¸ë‹¤
        $(this).siblings("#photo").html(fileName);
      });
    }

  </script>

</th:block>
<style>
  @font-face {
    font-family: 'Jamsil2';
    src: url('/font/The Jamsil OTF 2 Light.otf') format('opentype');
  }
</style>
<body>
<!-- navigation -->
<nav>
  <a href="/api/diary/list/1"><h1>ğ‘¨ğ‘®ğ‘¬ğ‘µğ‘«ğ‘¨</h1></a>
  <div class="menu">
    <div class="nav_menu"><a onclick="deleteEmotion()" href="/api/diary/list/1">
      <img src="/img/home.png" alt="í™ˆ">
      <div class="nav_span"><span>í™ˆ</span></div></a>
    </div>

    <div class="nav_menu"><a onclick="deleteEmotion()" href="/api/diary/save">
      <img src="/img/plus.png" alt="ë§Œë“¤ê¸°">
      <div class="nav_span"><span>ë‹¤ì´ì–´ë¦¬ ì‘ì„±</span></div></a>
    </div>

    <div class="nav_menu"><a onclick="deleteEmotion()" href="/api/diary/list/user" >
      <img class="pic" src="/img/user.png" alt="ë§ˆì´í˜ì´ì§€">
      <div class="nav_span"><span>ë‹¤ì´ì–´ë¦¬</span></div></a>
    </div>
    <div class="nav_menu">
      <hr style="width: 150px; margin-left: 0;">
      <a onclick="deleteEmotion()" href="/user/logout">
        <div class="nav_span"><span>ë¡œê·¸ì•„ì›ƒ</span></div>
      </a>
    </div>
  </div>
</nav>

<!-- main -->
<main>

  <div class="main_div">
    <h2 class="main_h1" style="margin: 0; font-size: 40px;">í•˜ë£¨ì˜ ê°ì • ê²½í—˜ì„ ê¸°ë¡í•˜ì—¬ ì‚¬ëŒë“¤ê³¼ ë‚˜ëˆ ë´…ì‹œë‹¤! </h2>
    <form role="form" id="diaryForm" enctype="multipart/form-data" action="/api/diary/save_proc" method="post">
      <div class="main_nickDate">
        <label for="content" style="font-family: 'Jamsil2'; margin-right: 5px;margin-bottom: 10px; font-weight: bold; font-size: 18px;">[[${nickName}]]</label>
        <div class="main_date">
          <label for="content" style="font-family: 'Jamsil2'; margin-bottom: 10px;">[[${strNowDate}]]</label>
        </div>
      </div>
      <div>
        <label class="main_label" for="content">ë‚´ìš©:</label>
        <textarea id="content" name="content" required style="font-size: 17px; font-family: 'Jamsil2'; margin-top: 10px; width: 100%; height: 300px; border: 1px solid #ddd; padding: 10px;"></textarea>
      </div>
      <div>
        <label class="main_label" for="photo" >ì‚¬ì§„:</label>
        <input type="file" id="photo"  name="itemImgFile" style="font-family: 'Jamsil2'; height: 100px; padding: 10px;">
      </div>
      <div class="main_btn">
        <button type="submit" style="font-family: 'Jamsil2'; margin-top: 10px; padding: 10px 20px; background-color: #000000; color: #fff; border: none; border-radius: 5px;font-weight: bold; cursor: pointer; font-size: 16px;">ë“±ë¡</button>
      </div>
    </form>
  </div>
</main>


<footer>
  <p class="insta-sccript">
    Copyright Â© 2023 - All right reserved by Agenda
  </p>
</footer>

</body>

</html>
