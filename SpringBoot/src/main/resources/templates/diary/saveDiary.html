<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
  <title>Instagram</title>
  <link href="/css/common.css" rel="stylesheet" type="text/css" />
  <link href="/css/diary.css" rel="stylesheet" type="text/css" />
  <!-- favicon -->
  <link rel="icon" href="/img/favicon.png">
  <link rel="instagram-icon" href="/img/favicon.png">
</head>
<!-- ì‚¬ìš©ì ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€ -->
<th:block layout:fragment="script">

  <script th:inline="javascript">
    $(document).ready(function(){
      let errorMessage = [[${errorMessage}]]; <!-- th:inline="javascript"ì´ ìˆì–´ì•¼ë§Œ ì—ëŸ¬ë©”ì‹œì§€ ì¸ì‹ë¨ -->
      if(errorMessage != null){
        alert(errorMessage);
      }

      bindDomEvent();

    });

    function bindDomEvent(){
      $("#photo").on("change", function() {
        let fileName = $(this).val().split("\\").pop();  //ì´ë¯¸ì§€ íŒŒì¼ëª…
        let fileExt = fileName.substring(fileName.lastIndexOf(".")+1); // í™•ì¥ì ì¶”ì¶œ
        fileExt = fileExt.toLowerCase(); //ì†Œë¬¸ì ë³€í™˜
        //íŒŒì¼ ì²¨ë¶€ ì‹œ ì´ë¯¸ì§€ íŒŒì¼ì¸ì§€ ê²€ì‚¬í•œë‹¤.
        if(fileExt != "jpg" && fileExt != "jpeg" && fileExt != "gif" && fileExt != "png" && fileExt != "bmp"){
          alert("ì´ë¯¸ì§€ íŒŒì¼ë§Œ ë“±ë¡ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.");
          return;
        }
        //í™”ë©´ì— íŒŒì¼ëª…ì„ ë‚˜íƒ€ë‚¸ë‹¤
        $(this).siblings("#photo").html(fileName);
      });
    }

  </script>

</th:block>
<body>
<!-- navigation -->
<nav>
  <a href="/api/diary/list/1"><h1>ğ‘¨ğ’ˆğ’†ğ’ğ’…ğ’‚</h1></a>
  <div class="menu">
    <div class="nav_menu"><a onclick="deleteEmotion()" href="/api/diary/list/1">
      <img src="/img/home.png" alt="í™ˆ">
      <div class="nav_span"><span>í™ˆ</span></div></a>
    </div>
    <script>
      function deleteEmotion() {
        localStorage.removeItem('emotion');
      }
    </script>

    <div class="nav_menu"><a href="/api/diary/save">
      <img src="/img/plus.png" alt="ë§Œë“¤ê¸°">
      <div class="nav_span"><span>ë§Œë“¤ê¸°</span></div></a>
    </div>

    <div class="nav_menu"><a href="/api/diary/list/user" >
      <img class="pic" src="/img/user.png" alt="ë§ˆì´í˜ì´ì§€">
      <div class="nav_span"><span th:text="${nickName}">í”„ë¡œí•„</span></div></a>
    </div>

    <div class="nav_menu"><a href="/user/logout">
      <div class="nav_span"><span>ë¡œê·¸ì•„ì›ƒ</span></div></a>
    </div>
  </div>
</nav>

<!-- main -->
<main>

  <div class="main_div">
    <h1 class="main_h1">ì¼ê¸° ë“±ë¡</h1>
    <form role="form" id="diaryForm" enctype="multipart/form-data" action="/api/diary/save_proc" method="post">
      <div class="main_nickDate">
        <label for="content" style="margin-bottom: 10px; font-weight: bold; font-size: 18px;">[[${nickName}]]</label>
        <div class="main_date">
          <label for="content" style="margin-bottom: 10px;">[[${strNowDate}]]</label>
        </div>
      </div>
      <div>
        <label class="main_label" for="content">ë‚´ìš©:</label>
        <textarea id="content" name="content" required style="margin-top: 10px; width: 100%; height: 300px; border: 1px solid #ddd; padding: 10px;"></textarea>
      </div>
      <div>
        <label class="main_label" for="photo" >ì‚¬ì§„:</label>
        <input type="file" id="photo"  name="itemImgFile" style="height: 100px; padding: 10px;">
      </div>
      <div class="main_btn">
        <button type="submit" style="margin-top: 10px; padding: 10px 20px; background-color: #000000; color: #fff; border: none; border-radius: 5px;font-weight: bold; cursor: pointer; font-size: 16px;">ë“±ë¡</button>
      </div>
    </form>
  </div>
</main>


<footer>
  <p class="insta-sccript">
    ì†Œê°œ âˆ™ ë„ì›€ë§ âˆ™ í™ë³´ ì„¼í„° âˆ™ API âˆ™ ì±„ìš© ì •ë³´ âˆ™ ê°œì¸ì •ë³´ì²˜ë¦¬ë°©ì¹¨ âˆ™ <br>ì•½ê´€ âˆ™ ìœ„ì¹˜ âˆ™ ì¸ê¸°ê³„ì • âˆ™ í•´ì‹œíƒœê·¸ âˆ™ ì–¸ì–´
    <br><br>
    Â© 2020 INSTAGRAM FROM FACEBOOK
  </p>
</footer>

</body>

</html>
